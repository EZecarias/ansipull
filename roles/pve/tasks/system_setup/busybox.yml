---

- name: tasks | system | create busybox directory
  file:
    path: /etc/systemd/system/{{ item.dir }}
    state: directory
    owner: root
    group: root
    mode: 0644
  with_items:
      - { dir: 'busybox-httpd.service.d' }

- name: Copy busybox httpd service file to appropriate folder
  copy:
    content: |
      [Unit]
      Description=Busybox HTTPD Server
      After=network.target #start after network is up

      [Service]
      Type=simple
      ExecStart=/usr/sbin/httpd -f -h ~/Sync/www -p 8080 -vvv

      [Install]
      WantedBy=multi-user.target
    dest: /etc/systemd/system/busybox-httpd.service.d/busybox-httpd.service
    mode: 0644
- name: Enable busybox httpd service at startup
  systemd:
    name: busybox-httpd.service
    enabled: yes
